<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Dialogue interactif</title>
<style>
  body {
    font-family: 'Courier New', monospace;
    background-color: #f8f8f8;
    color: #333;
    max-width: 600px;
    margin: 0 auto;
    padding: 40px 20px;
    line-height: 1.6;
  }
  #typing-text {
    white-space: pre-wrap;
    overflow: hidden;
    border-right: 2px solid #333;
    min-height: 300px;
  }
  .paranoia {
    display: inline-block;
    font-weight: normal;
    color: inherit;
    transition: all 2s ease-out;
  }
  .paranoia.final {
    font-size: 1.5em;
    color: #ff0000;
    font-weight: bold;
  }
  #continue-link {
    opacity: 0;
    display: inline-block;
    margin-top: 20px;
    padding: 10px 20px;
    background-color: #333;
    color: white;
    text-decoration: none;
    border-radius: 4px;
    transition: opacity 1s ease-in;
  }
  #continue-link.visible {
    opacity: 1;
  }
  .cursor {
    animation: blink 1s step-end infinite;
  }
  @keyframes blink {
    from, to { opacity: 1; }
    50% { opacity: 0; }
  }
</style>
</head>
<body>

<div id="typing-text"></div>
<a href="votre-lien.html" id="continue-link">Lancer les épreuves</a>

<script>
const textLines = [
  {text: "Madame,", delayAfter: 100},
  {text: "\n\nSoudainement, un doute m'a pris.", delayAfter: 100},
  {text: "\nUne angoisse paranoïaque.", delayAfter: 100},
  {text: "\nEt si vous étiez un robot?", delayAfter: 80},
  {text: "\nEt si depuis le début j'écrivais à un robot", delayAfter: 80},
  {text: "\nEt non à vous?", delayAfter: 2000}, // Pause plus longue ici
  {text: "\nMais ne vous en faites pas", delayAfter: 1000},
  {text: "\nJ'ai créé plusieurs épreuves qui me rassureront sur la question.", delayAfter: 1200},
  {text: "\n\nVous êtes prête?", delayAfter: 1000}
];

const typingElement = document.getElementById('typing-text');
const continueLink = document.getElementById('continue-link');
let lineIndex = 0;
let charIndex = 0;
let isParanoiaWord = false;
let paranoiaWordIndex = 0;
const targetWord = "paranoïaque.";

function typeWriter() {
  if (lineIndex < textLines.length) {
    const currentLine = textLines[lineIndex];
    
    if (charIndex < currentLine.text.length) {
      // Vérifie si nous commençons à taper le mot "paranoïaque"
      if (currentLine.text[charIndex] === targetWord[paranoiaWordIndex] && !isParanoiaWord) {
        if (paranoiaWordIndex === 0) {
          isParanoiaWord = true;
          typingElement.innerHTML += '<span class="paranoia">';
        }
        paranoiaWordIndex++;
      } else if (isParanoiaWord && currentLine.text[charIndex] !== targetWord[paranoiaWordIndex-1]) {
        isParanoiaWord = false;
        paranoiaWordIndex = 0;
        typingElement.innerHTML += '</span>';
      }
      
      // Ajoute le caractère suivant
      const nextChar = currentLine.text[charIndex];
      
      if (isParanoiaWord && paranoiaWordIndex === targetWord.length) {
        typingElement.innerHTML += nextChar + '</span>';
        isParanoiaWord = false;
        paranoiaWordIndex = 0;
        // Active l'animation du mot
        setTimeout(() => {
          const paranoiaSpans = document.querySelectorAll('.paranoia');
          if (paranoiaSpans.length > 0) {
            paranoiaSpans[paranoiaSpans.length-1].classList.add('final');
          }
        }, 500);
      } else {
        typingElement.textContent += nextChar;
      }
      
      charIndex++;
      setTimeout(typeWriter, Math.random() * 50 + 30); // Vitesse de frappe variable
    } else {
      // Fin de la ligne - pause avant la suivante
      charIndex = 0;
      lineIndex++;
      setTimeout(typeWriter, currentLine.delayAfter);
    }
  } else {
    // Fin du texte - affiche le curseur clignotant
    typingElement.innerHTML += '<span class="cursor">|</span>';
    // Affiche le lien
    continueLink.classList.add('visible');
    
    // Ferme toute balise span ouverte
    if (isParanoiaWord) {
      typingElement.innerHTML += '</span>';
    }
  }
}

// Démarrer l'animation
setTimeout(typeWriter, 1000);
</script>

</body>
</html>

